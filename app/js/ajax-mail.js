var envoyer=document.getElementById('sendMail');var form=document.querySelector('form'),nom=document.getElementById('nom'),prenom=document.getElementById('prenom'),mail=document.getElementById('mail'),texte=document.getElementById('message');envoyer.addEventListener('click',function(e){e.preventDefault();if(verifier()){message=nom.value+' '+prenom.value+' :'+mail.value+'\n\n'+texte.value;var a=new XMLHttpRequest();a.open('POST','http://sophietk.herokuapp.com/mail',true);a.setRequestHeader('Content-Type','application/json;charset=UTF-8');a.send(JSON.stringify({from:"sender@hihi.com",to:"tholfou@gmail.com",subject:"Portfolio",text:message}));a.addEventListener('readystatechange',function(){if(a.readyState===4){if(a.status===200){alert('Votre message a bien été envoyé');form.reset()}else{alert('Une erreur est survenue, votre message n\'a pas pu être envoyé')}}},false)}},false);function verifier(){verifierChamps(nom);verifierChamps(prenom);verifierChamps(texte);verifierMail(mail);if(verifierChamps(nom)&&verifierChamps(prenom)&&verifierChamps(texte)&&verifierMail(mail)){return true}else{return false}}function verifierChamps(a){if(a.value.length){return true}else{a.className='form-control invalide';a.addEventListener('keypress',function(){a.className='form-control'});return false}}function verifierMail(a){var b=/^[a-zA-Z0-9._\-]+@[a-zA-A0-9]+\.[a-zA-Z]{2,4}$/;if(b.test(a.value)){return true}else{var c=document.getElementById('erreur');a.className='form-control invalide';c.style.display='block';a.addEventListener('keypress',function(){a.className='form-control';c.style.display='none'});return false}}

